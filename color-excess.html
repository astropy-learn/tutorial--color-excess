
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Color excess</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-ZBXC3EFGGJ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-ZBXC3EFGGJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-ZBXC3EFGGJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'color-excess';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="None - Home"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="None - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Analyzing interstellar reddening and calculating synthetic photometry
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/astropy-learn/tutorial--color-excess" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/astropy-learn/tutorial--color-excess/issues/new?title=Issue%20on%20page%20%2Fcolor-excess.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analyzing interstellar reddening and calculating synthetic photometry</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analyzing-interstellar-reddening-and-calculating-synthetic-photometry">
<h1>Analyzing interstellar reddening and calculating synthetic photometry<a class="headerlink" href="#analyzing-interstellar-reddening-and-calculating-synthetic-photometry" title="Link to this heading">#</a></h1>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Link to this heading">#</a></h2>
<p>Kristen Larson, Lia Corrales, Stephanie T. Douglas, Kelle Cruz</p>
<p>Input from Emir Karamehmetoglu, Pey Lian Lim, Karl Gordon, Kevin Covey</p>
</section>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Investigate extinction curve shapes</p></li>
<li><p>Deredden spectral energy distributions and spectra</p></li>
<li><p>Calculate photometric extinction and reddening</p></li>
<li><p>Calculate synthetic photometry for a dust-reddened star by combining <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code> and <code class="docutils literal notranslate"><span class="pre">synphot</span></code></p></li>
<li><p>Convert from frequency to wavelength with <code class="docutils literal notranslate"><span class="pre">astropy.unit</span></code> equivalencies</p></li>
<li><p>Unit support for plotting with <code class="docutils literal notranslate"><span class="pre">astropy.visualization</span></code></p></li>
</ul>
</section>
<section id="keywords">
<h2>Keywords<a class="headerlink" href="#keywords" title="Link to this heading">#</a></h2>
<p>dust extinction, synphot, astroquery, units, photometry, extinction, physics, observational astronomy</p>
</section>
<section id="companion-content">
<h2>Companion Content<a class="headerlink" href="#companion-content" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2012PASP..124..140B/abstract">Bessell &amp; Murphy (2012)</a></p></li>
</ul>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this tutorial, we will look at some extinction curves from the literature, use one of those curves to deredden an observed spectrum, and practice invoking a background source flux in order to calculate magnitudes from an extinction model.</p>
<p>The primary libraries we’ll be using are <a class="reference external" href="https://dust-extinction.readthedocs.io/en/latest/">dust_extinction</a> and <a class="reference external" href="https://synphot.readthedocs.io/en/latest/">synphot</a>, which are <a class="reference external" href="https://www.astropy.org/affiliated/">Astropy affiliated packages</a>.</p>
<p>We recommend installing the two packages in this fashion:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">synphot</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">dust_extinction</span>
</pre></div>
</div>
<p>This tutorial requires v0.7 or later of <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code>. To ensure that all commands work properly, make sure you have the correct version installed. If you have v0.6 or earlier installed, run the following command to upgrade</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">dust_extinction</span> <span class="o">--</span><span class="n">upgrade</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pathlib</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.units</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">u</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.table</span><span class="w"> </span><span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dust_extinction.parameter_averages</span><span class="w"> </span><span class="kn">import</span> <span class="n">CCM89</span><span class="p">,</span> <span class="n">F99</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">synphot</span><span class="w"> </span><span class="kn">import</span> <span class="n">units</span><span class="p">,</span> <span class="n">config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">synphot</span><span class="w"> </span><span class="kn">import</span> <span class="n">SourceSpectrum</span><span class="p">,</span> <span class="n">SpectralElement</span><span class="p">,</span> <span class="n">Observation</span><span class="p">,</span> <span class="n">ReddeningLaw</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">synphot.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">BlackBodyNorm1D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.simbad</span><span class="w"> </span><span class="kn">import</span> <span class="n">Simbad</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astroquery.mast</span><span class="w"> </span><span class="kn">import</span> <span class="n">Observations</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">astropy.visualization</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h1>
<p>Dust in the interstellar medium (ISM) extinguishes background starlight.  The wavelength dependence of the extinction is such that short-wavelength light is extinguished more than long-wavelength light, and we call this effect <em>reddening</em>.</p>
<p>If you’re new to extinction, here is a brief introduction to the types of quantities involved.
The fractional change to the flux of starlight is
$<span class="math notranslate nohighlight">\(
\frac{dF_\lambda}{F_\lambda} = -\tau_\lambda
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the optical depth and depends on wavelength.  Integrating along the line of sight, the resultant flux is an exponential function of optical depth,
$<span class="math notranslate nohighlight">\(
\tau_\lambda = -\ln\left(\frac{F_\lambda}{F_{\lambda,0}}\right).
\)</span>$</p>
<p>With an eye to how we define magnitudes, we usually change the base from <span class="math notranslate nohighlight">\(e\)</span> to 10,<br />
$<span class="math notranslate nohighlight">\(
\tau_\lambda = -2.303\log\left(\frac{F_\lambda}{F_{\lambda,0}}\right),
\)</span>$</p>
<p>and define an extinction <span class="math notranslate nohighlight">\(A_\lambda = 1.086 \,\tau_\lambda\)</span> so that
$<span class="math notranslate nohighlight">\(
A_\lambda = -2.5\log\left(\frac{F_\lambda}{F_{\lambda,0}}\right).
\)</span>$</p>
<p>There are two basic take-home messages from this derivation:</p>
<ul class="simple">
<li><p>Extinction introduces a multiplying factor <span class="math notranslate nohighlight">\(10^{-0.4 A_\lambda}\)</span> to the flux.</p></li>
<li><p>Extinction is defined relative to the flux without dust, <span class="math notranslate nohighlight">\(F_{\lambda,0}\)</span>.</p></li>
</ul>
<p>Once astropy and the affiliated packages are installed, we can import from them as needed:</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-1-investigate-extinction-models">
<h1>Example 1: Investigate Extinction Models<a class="headerlink" href="#example-1-investigate-extinction-models" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code> package provides various models for extinction <span class="math notranslate nohighlight">\(A_\lambda\)</span> normalized to <span class="math notranslate nohighlight">\(A_V\)</span>.  The shapes of normalized curves are relatively (and perhaps surprisingly) uniform in the Milky Way.  The little variation that exists is often parameterized by the ratio of extinction (<span class="math notranslate nohighlight">\(A_V\)</span>) to reddening  in the blue-visual (<span class="math notranslate nohighlight">\(E_{B-V}\)</span>),
$<span class="math notranslate nohighlight">\(
R_V \equiv \frac{A_V}{E_{B-V}}
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(E_{B-V}\)</span> is differential extinction <span class="math notranslate nohighlight">\(A_B-A_V\)</span>.  In this example, we show the <span class="math notranslate nohighlight">\(R_V\)</span>-parameterization for the Clayton, Cardelli, &amp; Mathis (1989, CCM) and the Fitzpatrick (1999) models. <a class="reference external" href="https://dust-extinction.readthedocs.io/en/latest/dust_extinction/model_flavors.html">More model options are available in the <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code> documentation.</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create wavelengths array.</span>
<span class="n">wav</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="p">[</span><span class="n">CCM89</span><span class="p">,</span> <span class="n">F99</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">R</span> <span class="ow">in</span> <span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">):</span>
        <span class="c1"># Initialize the extinction model</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">Rv</span><span class="o">=</span><span class="n">R</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">wav</span><span class="p">,</span> <span class="n">ext</span><span class="p">(</span><span class="n">wav</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; R=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">R</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\lambda^{-1}$ ($\mu$m$^{-1}$)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;A($\lambda$) / A(V)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Some Extinction Laws&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/39ba919be79cb968c8b913c27f5e0ad1db963e380a4c849cfd0aa2db63db9154.png" src="_images/39ba919be79cb968c8b913c27f5e0ad1db963e380a4c849cfd0aa2db63db9154.png" />
</div>
</div>
<p>Astronomers studying the ISM often display extinction curves against inverse wavelength (wavenumber) to show the ultraviolet variation, as we do here.  Infrared extinction varies much less and approaches zero at long wavelength in the absence of wavelength-independent, or grey, extinction.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-2-deredden-a-spectrum">
<h1>Example 2: Deredden a Spectrum<a class="headerlink" href="#example-2-deredden-a-spectrum" title="Link to this heading">#</a></h1>
<p>Here we deredden (unextinguish) the IUE ultraviolet spectrum and optical photometry of the star <span class="math notranslate nohighlight">\(\rho\)</span> Oph (HD 147933).</p>
<p>First, we will use astroquery to fetch the archival <a class="reference external" href="https://archive.stsci.edu/iue/">IUE spectrum from MAST</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">download_dir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="s2">&quot;~/.astropy/cache/astroquery/Mast&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="n">download_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">obsTable</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">query_object</span><span class="p">(</span><span class="s2">&quot;HD 147933&quot;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="s2">&quot;1 arcsec&quot;</span><span class="p">)</span>
<span class="n">obsTable_spec</span> <span class="o">=</span> <span class="n">obsTable</span><span class="p">[</span><span class="n">obsTable</span><span class="p">[</span><span class="s2">&quot;dataproduct_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;spectrum&quot;</span><span class="p">]</span>
<span class="n">obsTable_spec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table masked=True length=131</i>
<table id="table140333622946480" class="table-striped table-bordered table-condensed">
<thead><tr><th>intentType</th><th>obs_collection</th><th>provenance_name</th><th>instrument_name</th><th>project</th><th>filters</th><th>wavelength_region</th><th>target_name</th><th>target_classification</th><th>obs_id</th><th>s_ra</th><th>s_dec</th><th>dataproduct_type</th><th>proposal_pi</th><th>calib_level</th><th>t_min</th><th>t_max</th><th>t_exptime</th><th>em_min</th><th>em_max</th><th>obs_title</th><th>t_obs_release</th><th>proposal_id</th><th>proposal_type</th><th>sequence_number</th><th>s_region</th><th>jpegURL</th><th>dataURL</th><th>dataRights</th><th>mtFlag</th><th>srcDen</th><th>obsid</th><th>distance</th></tr></thead>
<thead><tr><th>str7</th><th>str5</th><th>str7</th><th>str13</th><th>str6</th><th>str11</th><th>str16</th><th>str21</th><th>str37</th><th>str53</th><th>float64</th><th>float64</th><th>str10</th><th>str22</th><th>int64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>str117</th><th>float64</th><th>str6</th><th>str6</th><th>int64</th><th>str23309</th><th>str137</th><th>str137</th><th>str6</th><th>bool</th><th>float64</th><th>str9</th><th>float64</th></tr></thead>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F770W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx101_00001_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>16.65</td><td>6600.0</td><td>8800.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>1</td><td>POLYGON 246.39627878764 -23.44647954388 246.39724301361 -23.44660356899 246.39708951124 -23.44763481981 246.3961218565 -23.44749665486</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358393</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F770W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx102_00002_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>16.65</td><td>6600.0</td><td>8800.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>2</td><td>POLYGON 246.39563648091 -23.44666834292 246.39660070765 -23.44679237198 246.39644720004 -23.44782362217 246.39547954459 -23.44768545326</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358394</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F770W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx103_00003_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>16.65</td><td>6600.0</td><td>8800.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>3</td><td>POLYGON 246.39618169229 -23.44654111159 246.39714591862 -23.44666513731 246.39699241542 -23.44769638803 246.39602476033 -23.44755822248</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358395</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F770W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx104_00004_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>16.65</td><td>6600.0</td><td>8800.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>4</td><td>POLYGON 246.39553961734 -23.44673086913 246.39650384445 -23.44685489878 246.39635033602 -23.44788614888 246.39538268021 -23.44774797937</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358396</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F1000W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx105_00001_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>19.425</td><td>9000.0</td><td>11000.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>5</td><td>POLYGON 246.39627878764 -23.44647954388 246.39724301361 -23.44660356899 246.39708951124 -23.44763481981 246.3961218565 -23.44749665486</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358397</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F1000W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx106_00002_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>19.425</td><td>9000.0</td><td>11000.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>6</td><td>POLYGON 246.39563648091 -23.44666834292 246.39660070765 -23.44679237198 246.39644720004 -23.44782362217 246.39547954459 -23.44768545326</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358398</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F1000W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx107_00003_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>19.425</td><td>9000.0</td><td>11000.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>7</td><td>POLYGON 246.39618169229 -23.44654111159 246.39714591862 -23.44666513731 246.39699241542 -23.44769638803 246.39602476033 -23.44755822248</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358399</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F1000W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx108_00004_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>19.425</td><td>9000.0</td><td>11000.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>8</td><td>POLYGON 246.39553961734 -23.44673086913 246.39650384445 -23.44685489878 246.39635033602 -23.44788614888 246.39538268021 -23.44774797937</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358400</td><td>0.0</td></tr>
<tr><td>science</td><td>JWST</td><td>APT</td><td>MIRI/IFU</td><td>JWST</td><td>F1280W</td><td>INFRARED</td><td>HD147933</td><td>--</td><td>jw07715021001_xx109_00001_miri</td><td>246.39632750000004</td><td>-23.447175000000016</td><td>spectrum</td><td>Decleir, Marjorie</td><td>-1</td><td>nan</td><td>nan</td><td>19.425</td><td>11600.0</td><td>14000.0</td><td>Unique insights into the chemical composition of interstellar silicate dust grains in the Milky Way</td><td>nan</td><td>7715</td><td>GO</td><td>9</td><td>POLYGON 246.39627878764 -23.44647954388 246.39724301361 -23.44660356899 246.39708951124 -23.44763481981 246.3961218565 -23.44749665486</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>250358401</td><td>0.0</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>science</td><td>HST</td><td>CALHRS</td><td>HRS</td><td>HST</td><td>MIRROR-N1</td><td>UV</td><td>HD147933A</td><td>STAR;B0-B2 V-IV;</td><td>z34r0101t</td><td>246.39650225999998</td><td>-23.44680653022271</td><td>spectrum</td><td>Seab, C. Gregory</td><td>1</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>STRUCTURALLY RESOLVED ABUNDANCES AND DEPLETIONS IN THE RHO OPH CLOUD</td><td>50525.53306704</td><td>5891</td><td>GO</td><td>--</td><td>POLYGON 246.39634951 -23.44711966 246.39616095 -23.44666639 246.39665501 -23.4464934 246.39684357 -23.44694667 246.39634951 -23.44711966</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24790609</td><td>0.21376357547654684</td></tr>
<tr><td>science</td><td>HST</td><td>CALHRS</td><td>HRS/1</td><td>HST</td><td>MIRROR-N1</td><td>UV</td><td>HD147933A</td><td>STAR;B0-B2 V-IV;</td><td>z34r0102t</td><td>246.3965495632</td><td>-23.44717233421</td><td>spectrum</td><td>Seab, C. Gregory</td><td>1</td><td>50159.585271331016</td><td>50159.58770188657</td><td>0.0</td><td>nan</td><td>nan</td><td>STRUCTURALLY RESOLVED ABUNDANCES AND DEPLETIONS IN THE RHO OPH CLOUD</td><td>50525.53208328</td><td>5891</td><td>GO</td><td>--</td><td>POLYGON 246.39634951 -23.44711966 246.39616095 -23.44666639 246.39665501 -23.4464934 246.39684357 -23.44694667 246.39634951 -23.44711966</td><td>--</td><td>mast:HST/product/z34r0102t_d1f.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24790610</td><td>0.21376357547654684</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>G430M</td><td>OPTICAL</td><td>HD147933</td><td>STAR;B0-B2 V-IV</td><td>oc9a01zrq</td><td>246.3962992355</td><td>-23.44727986837</td><td>spectrum</td><td>Cordiner, Martin A.</td><td>1</td><td>56904.983215775464</td><td>56904.983227349534</td><td>1.0</td><td>302.0</td><td>561.0</td><td>Probing the nature of small-scale structure towards rho Oph stars: A new avenue in diffuse interstellar band research</td><td>57270.08427085</td><td>13365</td><td>GO</td><td>--</td><td>POLYGON 246.3960922697417 -23.447426515668877 246.39608323714722 -23.447415107781204 246.39648130429998 -23.447149826707935 246.39649033689443 -23.44716123459561 246.3960922697417 -23.447426515668877</td><td>--</td><td>mast:HST/product/oc9a01zrq_raw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24532244</td><td>0.22412014259879035</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/FUV-MAMA</td><td>HST</td><td>E140H</td><td>UV</td><td>HD147933</td><td>STAR;B0-B2 V-IV</td><td>oc9a01010</td><td>246.3962992354</td><td>-23.44727986853</td><td>spectrum</td><td>Cordiner, Martin A.</td><td>3</td><td>56904.988200231484</td><td>56905.00924186342</td><td>1818.0</td><td>114.0</td><td>170.0</td><td>Probing the nature of small-scale structure towards rho Oph stars: A new avenue in diffuse interstellar band research</td><td>57270.08590281</td><td>13365</td><td>GO</td><td>--</td><td>POLYGON 246.3926036788305 -23.44975139274687 246.39259464623592 -23.449739984859278 246.3998692692162 -23.444892009287518 246.3998783018108 -23.44490341717511 246.3926036788305 -23.44975139274687</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24969540</td><td>0.2243659960845965</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/NUV-MAMA</td><td>HST</td><td>E230H</td><td>UV</td><td>HD147933</td><td>STAR;B0-B2 V-IV</td><td>oc9a01020</td><td>246.3962992352</td><td>-23.44727986952</td><td>spectrum</td><td>Cordiner, Martin A.</td><td>3</td><td>56905.04060760417</td><td>56905.07464699074</td><td>2941.0</td><td>162.0</td><td>315.0</td><td>Probing the nature of small-scale structure towards rho Oph stars: A new avenue in diffuse interstellar band research</td><td>57270.35305557</td><td>13365</td><td>GO</td><td>--</td><td>POLYGON 246.39260367863048 -23.449751393736868 246.3925946460359 -23.449739985849277 246.39986926901622 -23.444892010277517 246.3998783016108 -23.444903418165108 246.39260367863048 -23.449751393736868</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24969541</td><td>0.22438001793898651</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/NUV-MAMA</td><td>HST</td><td>E230H</td><td>UV</td><td>-RHO-OPH-A</td><td>STAR;B0-B2 V-IV</td><td>oenc04010</td><td>246.3962977744</td><td>-23.44732217873</td><td>spectrum</td><td>Ramburuth-Hurt, Tanita</td><td>3</td><td>59837.114333530095</td><td>59837.134993252315</td><td>1785.0</td><td>162.0</td><td>315.0</td><td>Inhomogeneities and pristine gas infall in the ISM</td><td>60018.23140046</td><td>16750</td><td>GO</td><td>--</td><td>POLYGON 246.39627822178693 -23.44734581210493 246.3962670101285 -23.447331321292502 246.396317331745 -23.44729855147096 246.39632854340343 -23.44731304228339 246.39627822178693 -23.44734581210493</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>92983052</td><td>0.4443654146632724</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>G430M</td><td>OPTICAL</td><td>-RHO-OPH-A</td><td>STAR;B0-B2 V-IV</td><td>oenc04t8q</td><td>246.3962977744</td><td>-23.44732217863</td><td>spectrum</td><td>Ramburuth-Hurt, Tanita</td><td>1</td><td>59837.10980130787</td><td>59837.10981288194</td><td>1.0</td><td>302.0</td><td>561.0</td><td>Inhomogeneities and pristine gas infall in the ISM</td><td>60018.14853002</td><td>16750</td><td>GO</td><td>--</td><td>POLYGON 246.39627822178667 -23.44734581200475 246.3962670101284 -23.44733132119222 246.39631733174525 -23.44729855137114 246.39632854340354 -23.447313042183673 246.39627822178667 -23.44734581200475</td><td>--</td><td>mast:HST/product/oenc04t8q_raw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>92969831</td><td>0.4443654146632724</td></tr>
<tr><td>science</td><td>HST</td><td>CALSTIS</td><td>STIS/CCD</td><td>HST</td><td>G430M</td><td>OPTICAL</td><td>-RHO-OPH-A</td><td>STAR;B0-B2 V-IV</td><td>oenc04t9q</td><td>246.3962977744</td><td>-23.4473221787</td><td>spectrum</td><td>Ramburuth-Hurt, Tanita</td><td>1</td><td>59837.111653900465</td><td>59837.111665474535</td><td>1.0</td><td>302.0</td><td>561.0</td><td>Inhomogeneities and pristine gas infall in the ISM</td><td>60018.14840271</td><td>16750</td><td>GO</td><td>--</td><td>POLYGON 246.39627822178667 -23.44734581207475 246.3962670101284 -23.44733132126222 246.39631733174525 -23.44729855144114 246.39632854340354 -23.447313042253672 246.39627822178667 -23.44734581207475</td><td>--</td><td>mast:HST/product/oenc04t9q_raw.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>92969829</td><td>0.4443654146632724</td></tr>
<tr><td>science</td><td>HST</td><td>CALHRS</td><td>HRS</td><td>HST</td><td>MIRROR-A2</td><td>UV</td><td>HD147933</td><td>STAR;</td><td>z2b95101t</td><td>246.396760975</td><td>-23.44740896772272</td><td>spectrum</td><td>Lambert, David L.</td><td>1</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>nan</td><td>THE NATURE OF INTERSTELLAR CLOUD ENVELOPES -- PHYSICAL CONDITIONS AND STRUCTURE</td><td>50252.51012729</td><td>5389</td><td>GO</td><td>--</td><td>POLYGON 246.39664535 -23.44708272 246.39711658 -23.44730289 246.3968766 -23.44773521 246.39640537 -23.44751505 246.39664535 -23.44708272</td><td>--</td><td>--</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24783889</td><td>0.7843082610073624</td></tr>
<tr><td>science</td><td>HST</td><td>CALHRS</td><td>HRS/2</td><td>HST</td><td>MIRROR-A2</td><td>UV</td><td>HD147933</td><td>STAR;</td><td>z2b95102t</td><td>246.3964583333</td><td>-23.44716666667</td><td>spectrum</td><td>Lambert, David L.</td><td>1</td><td>49885.25756288195</td><td>49885.26320234954</td><td>0.0</td><td>nan</td><td>nan</td><td>THE NATURE OF INTERSTELLAR CLOUD ENVELOPES -- PHYSICAL CONDITIONS AND STRUCTURE</td><td>50252.51082169</td><td>5389</td><td>GO</td><td>--</td><td>POLYGON 246.39664535 -23.44708272 246.39711658 -23.44730289 246.3968766 -23.44773521 246.39640537 -23.44751505 246.39664535 -23.44708272</td><td>--</td><td>mast:HST/product/z2b95102t_d1f.fits</td><td>PUBLIC</td><td>False</td><td>nan</td><td>24783890</td><td>0.7843082610073624</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># retrieve a specific &#39;obs_id&#39; corresponding to the IUE spectrum</span>
<span class="n">obsTable_spec</span><span class="o">.</span><span class="n">add_index</span><span class="p">(</span><span class="s2">&quot;obs_id&quot;</span><span class="p">)</span>
<span class="n">obsids</span> <span class="o">=</span> <span class="n">obsTable_spec</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;lwr05639&quot;</span><span class="p">][</span><span class="s2">&quot;obsid&quot;</span><span class="p">]</span>

<span class="n">dataProductsByID</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">get_product_list</span><span class="p">(</span><span class="n">obsids</span><span class="p">)</span>
<span class="n">manifest</span> <span class="o">=</span> <span class="n">Observations</span><span class="o">.</span><span class="n">download_products</span><span class="p">(</span>
    <span class="n">dataProductsByID</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">download_dir</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.elbll.gz with expected size 55417. [astroquery.query]
INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.lilo.gz with expected size 446101. [astroquery.query]
INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.melol.gz with expected size 6464. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.raw.gz with expected size 285802. [astroquery.query]
INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.rilo.gz with expected size 291749. [astroquery.query]
INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.silo.gz with expected size 89943. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.gif with expected size 7406. [astroquery.query]
INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639.mxlo.gz with expected size 18165. [astroquery.query]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO: Found cached file /home/runner/.astropy/cache/astroquery/Mast/mastDownload/IUE/lwr05639/lwr05639mxlo_vo.fits with expected size 48960. [astroquery.query]
</pre></div>
</div>
</div>
</div>
<p>We read the downloaded files into an astropy table:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_lwr</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">download_dir</span> <span class="o">/</span> <span class="s2">&quot;mastDownload/IUE/lwr05639/lwr05639mxlo_vo.fits&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t_lwr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         WAVE                    FLUX            ... QUALITY
       Angstrom         erg / (Angstrom s cm2)   ...        
--------------------- -------------------------- ... -------
1851.4327 .. 3348.901 2.08651e-10 .. 7.39839e-11 ... 0 .. 16
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.quantity</span></code> extension in the next lines will read the Table columns into Quantity vectors.  Quantities keep the units of the Table column attached to the numpy array values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wav_UV</span> <span class="o">=</span> <span class="n">t_lwr</span><span class="p">[</span><span class="s2">&quot;WAVE&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,]</span><span class="o">.</span><span class="n">quantity</span>
<span class="n">UVflux</span> <span class="o">=</span> <span class="n">t_lwr</span><span class="p">[</span><span class="s2">&quot;FLUX&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">,]</span><span class="o">.</span><span class="n">quantity</span>
</pre></div>
</div>
</div>
</div>
<p>Now, we use astroquery again to fetch photometry from Simbad to go with the IUE spectrum:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_query</span> <span class="o">=</span> <span class="n">Simbad</span><span class="p">()</span>
<span class="n">custom_query</span><span class="o">.</span><span class="n">add_votable_fields</span><span class="p">(</span><span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">)</span>
<span class="n">phot_table</span> <span class="o">=</span> <span class="n">custom_query</span><span class="o">.</span><span class="n">query_object</span><span class="p">(</span><span class="s2">&quot;HD 147933&quot;</span><span class="p">)</span>
<span class="n">Umag</span> <span class="o">=</span> <span class="n">phot_table</span><span class="p">[</span><span class="s2">&quot;U&quot;</span><span class="p">]</span>
<span class="n">Bmag</span> <span class="o">=</span> <span class="n">phot_table</span><span class="p">[</span><span class="s2">&quot;B&quot;</span><span class="p">]</span>
<span class="n">Vmag</span> <span class="o">=</span> <span class="n">phot_table</span><span class="p">[</span><span class="s2">&quot;V&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>To convert the photometry to flux, we look up some <a class="reference external" href="http://ned.ipac.caltech.edu/help/photoband.lst">properties of the photometric passbands</a>, including the flux of a magnitude zero star through the each passband, also known as the zero-point of the passband.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wav_U</span> <span class="o">=</span> <span class="mf">0.3660</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
<span class="n">zeroflux_U_nu</span> <span class="o">=</span> <span class="mf">1.81e-23</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Watt</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span>
<span class="n">wav_B</span> <span class="o">=</span> <span class="mf">0.4400</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
<span class="n">zeroflux_B_nu</span> <span class="o">=</span> <span class="mf">4.26e-23</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Watt</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span>
<span class="n">wav_V</span> <span class="o">=</span> <span class="mf">0.5530</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
<span class="n">zeroflux_V_nu</span> <span class="o">=</span> <span class="mf">3.64e-23</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Watt</span> <span class="o">/</span> <span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The zero-points that we found for the optical passbands are not in the same units as the IUE fluxes.  To make matters worse, the zero-point fluxes are <span class="math notranslate nohighlight">\(F_\nu\)</span> and the IUE fluxes are <span class="math notranslate nohighlight">\(F_\lambda\)</span>.  To convert between them, the wavelength is needed.  Fortunately, astropy provides an easy way to make the conversion with <em>equivalencies</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zeroflux_U</span> <span class="o">=</span> <span class="n">zeroflux_U_nu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
    <span class="n">u</span><span class="o">.</span><span class="n">erg</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">spectral_density</span><span class="p">(</span><span class="n">wav_U</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">zeroflux_B</span> <span class="o">=</span> <span class="n">zeroflux_B_nu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
    <span class="n">u</span><span class="o">.</span><span class="n">erg</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">spectral_density</span><span class="p">(</span><span class="n">wav_B</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">zeroflux_V</span> <span class="o">=</span> <span class="n">zeroflux_V_nu</span><span class="o">.</span><span class="n">to</span><span class="p">(</span>
    <span class="n">u</span><span class="o">.</span><span class="n">erg</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">spectral_density</span><span class="p">(</span><span class="n">wav_V</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can convert from photometry to flux using the definition of magnitude:
$<span class="math notranslate nohighlight">\(
F=F_0\ 10^{-0.4\, m}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Uflux</span> <span class="o">=</span> <span class="n">zeroflux_U</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">Umag</span><span class="p">)</span>
<span class="n">Bflux</span> <span class="o">=</span> <span class="n">zeroflux_B</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">Bmag</span><span class="p">)</span>
<span class="n">Vflux</span> <span class="o">=</span> <span class="n">zeroflux_V</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">Vmag</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Using astropy quantities allow us to take advantage of astropy’s unit support in plotting. <a class="reference external" href="http://docs.astropy.org/en/stable/units/quantity.html#plotting-quantities">Calling <code class="docutils literal notranslate"><span class="pre">astropy.visualization.quantity_support</span></code> explicitly turns the feature on.</a>  Then, when quantity objects are passed to matplotlib plotting functions, the axis labels are automatically labeled with the unit of the quantity.  In addition, quantities are converted automatically into the same units when combining multiple plots on the same axes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">astropy</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">quantity_support</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav_UV</span><span class="p">,</span> <span class="n">UVflux</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;UV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav_V</span><span class="p">,</span> <span class="n">Vflux</span><span class="p">,</span> <span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;U, B, V&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav_B</span><span class="p">,</span> <span class="n">Bflux</span><span class="p">,</span> <span class="s2">&quot;ko&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav_U</span><span class="p">,</span> <span class="n">Uflux</span><span class="p">,</span> <span class="s2">&quot;ko&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3e-10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;rho Oph&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/137cd2a4df58b54f38b5ef19e4ce20564db093cfa5edce3a652568cfe68fc5f8.png" src="_images/137cd2a4df58b54f38b5ef19e4ce20564db093cfa5edce3a652568cfe68fc5f8.png" />
</div>
</div>
<p>Finally, we initialize the extinction model, choosing values <span class="math notranslate nohighlight">\(R_V = 5\)</span> and <span class="math notranslate nohighlight">\(E_{B-V} = 0.5\)</span>.  This star is famous in the ISM community for having large-<span class="math notranslate nohighlight">\(R_V\)</span> dust in the line of sight.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Rv</span> <span class="o">=</span> <span class="mf">5.0</span>  <span class="c1"># Usually around 3, but about 5 for this star.</span>
<span class="n">Ebv</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">ext</span> <span class="o">=</span> <span class="n">F99</span><span class="p">(</span><span class="n">Rv</span><span class="o">=</span><span class="n">Rv</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To extinguish (redden) a spectrum, multiply by the <code class="docutils literal notranslate"><span class="pre">ext.extinguish</span></code> function.  To unextinguish (deredden), divide by the same <code class="docutils literal notranslate"><span class="pre">ext.extinguish</span></code>, as we do here:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">wav_UV</span><span class="p">,</span> <span class="n">UVflux</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;UV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">wav_V</span><span class="p">,</span> <span class="n">Vflux</span><span class="p">,</span> <span class="s2">&quot;ko&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;U, B, V&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">wav_B</span><span class="p">,</span> <span class="n">Bflux</span><span class="p">,</span> <span class="s2">&quot;ko&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">wav_U</span><span class="p">,</span> <span class="n">Uflux</span><span class="p">,</span> <span class="s2">&quot;ko&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span>
    <span class="n">wav_UV</span><span class="p">,</span>
    <span class="n">UVflux</span> <span class="o">/</span> <span class="n">ext</span><span class="o">.</span><span class="n">extinguish</span><span class="p">(</span><span class="n">wav_UV</span><span class="p">,</span> <span class="n">Ebv</span><span class="o">=</span><span class="n">Ebv</span><span class="p">),</span>
    <span class="s2">&quot;b&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dereddened: EBV=0.5, RV=5&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span>
    <span class="n">wav_V</span><span class="p">,</span>
    <span class="n">Vflux</span> <span class="o">/</span> <span class="n">ext</span><span class="o">.</span><span class="n">extinguish</span><span class="p">(</span><span class="n">wav_V</span><span class="p">,</span> <span class="n">Ebv</span><span class="o">=</span><span class="n">Ebv</span><span class="p">),</span>
    <span class="s2">&quot;ro&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dereddened: EBV=0.5, RV=5&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">wav_B</span><span class="p">,</span> <span class="n">Bflux</span> <span class="o">/</span> <span class="n">ext</span><span class="o">.</span><span class="n">extinguish</span><span class="p">(</span><span class="n">wav_B</span><span class="p">,</span> <span class="n">Ebv</span><span class="o">=</span><span class="n">Ebv</span><span class="p">),</span> <span class="s2">&quot;ro&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">wav_U</span><span class="p">,</span> <span class="n">Uflux</span> <span class="o">/</span> <span class="n">ext</span><span class="o">.</span><span class="n">extinguish</span><span class="p">(</span><span class="n">wav_U</span><span class="p">,</span> <span class="n">Ebv</span><span class="o">=</span><span class="n">Ebv</span><span class="p">),</span> <span class="s2">&quot;ro&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;rho Oph&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b43d507c2f808ef6186bb94dafe1403fe5a5789d53ca9750cadbde06a48e19e2.png" src="_images/b43d507c2f808ef6186bb94dafe1403fe5a5789d53ca9750cadbde06a48e19e2.png" />
</div>
</div>
<p>Notice that, by dereddening the spectrum, the absorption feature at 2175 Angstrom is removed.  This feature can also be seen as the prominent bump in the extinction curves in Example 1.  That we have smoothly removed the 2175 Angstrom feature suggests that the values we chose, <span class="math notranslate nohighlight">\(R_V = 5\)</span> and <span class="math notranslate nohighlight">\(E_{B-V} = 0.5\)</span>, are a reasonable model for the foreground dust.</p>
<p>Those experienced with dereddening should notice that that <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code> returns <span class="math notranslate nohighlight">\(A_\lambda/A_V\)</span>, while other routines like the IDL fm_unred procedure often return <span class="math notranslate nohighlight">\(A_\lambda/E_{B-V}\)</span> by default and need to be divided by <span class="math notranslate nohighlight">\(R_V\)</span> in order to compare directly with <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code>.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-3-calculate-color-excess-with-synphot">
<h1>Example 3: Calculate Color Excess with <code class="docutils literal notranslate"><span class="pre">synphot</span></code><a class="headerlink" href="#example-3-calculate-color-excess-with-synphot" title="Link to this heading">#</a></h1>
<p>Calculating broadband <em>photometric</em> extinction is harder than it might look at first.  All we have to do is look up <span class="math notranslate nohighlight">\(A_\lambda\)</span> for a particular passband, right?  Under the right conditions, yes.  In general, no.</p>
<p>Remember that we have to integrate over a passband to get synthetic photometry,
$<span class="math notranslate nohighlight">\(
A = -2.5\log\left(\frac{\int W_\lambda F_{\lambda,0} 10^{-0.4A_\lambda} d\lambda}{\int W_\lambda F_{\lambda,0} d\lambda} \right),
\)</span>$</p>
<p>where <span class="math notranslate nohighlight">\(W_\lambda\)</span> is the fraction of incident energy transmitted through a filter.  See the detailed appendix in <a class="reference external" href="https://ui.adsabs.harvard.edu/#abs/2012PASP..124..140B/abstract">Bessell &amp; Murphy (2012)</a>
for an excellent review of the issues and common misunderstandings in synthetic photometry.</p>
<p>There is an important point to be made here. The expression above does not simplify any further. Strictly speaking, it is impossible to convert spectral extinction <span class="math notranslate nohighlight">\(A_\lambda\)</span> into a magnitude system without knowing the wavelength dependence of the source’s original flux across the filter in question.  As a special case, if we assume that the source flux is constant in the band (i.e. <span class="math notranslate nohighlight">\(F_\lambda = F\)</span>), then we can cancel these factors out from the integrals, and extinction in magnitudes becomes the weighted average of the extinction factor across the filter in question. In that special case, <span class="math notranslate nohighlight">\(A_\lambda\)</span> at <span class="math notranslate nohighlight">\(\lambda_{\rm eff}\)</span> is a good approximation for magnitude extinction.</p>
<p>In this example, we will demonstrate the more general calculation of photometric extinction.  We use a blackbody curve for the flux before the dust, apply an extinction curve, and perform synthetic photometry to calculate extinction and reddening in a magnitude system.</p>
<p>First, let’s get the filter transmission curves:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Optional, for when the STScI ftp server is not answering:</span>
<span class="n">root_url</span> <span class="o">=</span> <span class="s2">&quot;http://ssb.stsci.edu/trds/&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">vega_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;calspec/alpha_lyr_stis_010.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">johnson_u_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/johnson_u_004_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">johnson_b_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/johnson_b_004_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">johnson_v_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/johnson_v_004_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">johnson_r_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/johnson_r_003_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">johnson_i_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/johnson_i_003_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">bessel_j_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/bessell_j_003_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">bessel_h_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/bessell_h_004_syn.fits&quot;</span>
<span class="n">config</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">bessel_k_file</span> <span class="o">=</span> <span class="n">root_url</span> <span class="o">+</span> <span class="s2">&quot;comp/nonhst/bessell_k_003_syn.fits&quot;</span>

<span class="n">u_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;johnson_u&quot;</span><span class="p">)</span>
<span class="n">b_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;johnson_b&quot;</span><span class="p">)</span>
<span class="n">v_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;johnson_v&quot;</span><span class="p">)</span>
<span class="n">r_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;johnson_r&quot;</span><span class="p">)</span>
<span class="n">i_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;johnson_i&quot;</span><span class="p">)</span>
<span class="n">j_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;bessel_j&quot;</span><span class="p">)</span>
<span class="n">h_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;bessel_h&quot;</span><span class="p">)</span>
<span class="n">k_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;bessel_k&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you are running this with your own python, see the <a class="reference external" href="https://synphot.readthedocs.io/en/latest/#installation-and-setup">synphot documentation</a> on how to install your own copy of the necessary files.</p>
<p>Next, let’s make a background flux to which we will apply extinction.  Here we make a 10,000 K blackbody using the model mechanism from within <code class="docutils literal notranslate"><span class="pre">synphot</span></code> and normalize it to <span class="math notranslate nohighlight">\(V\)</span> = 10 in the Vega-based magnitude system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First, create a blackbody at some temperature.</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">SourceSpectrum</span><span class="p">(</span><span class="n">BlackBodyNorm1D</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="c1"># sp.plot(left=1, right=15000, flux_unit=&#39;flam&#39;, title=&#39;Blackbody&#39;)</span>

<span class="c1"># Get the Vega spectrum as the zero point flux.</span>
<span class="n">vega</span> <span class="o">=</span> <span class="n">SourceSpectrum</span><span class="o">.</span><span class="n">from_vega</span><span class="p">()</span>
<span class="c1"># vega.plot(left=1, right=15000)</span>

<span class="c1"># Normalize the blackbody to some chosen magnitude, say V = 10.</span>
<span class="n">vmag</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">v_band</span> <span class="o">=</span> <span class="n">SpectralElement</span><span class="o">.</span><span class="n">from_filter</span><span class="p">(</span><span class="s2">&quot;johnson_v&quot;</span><span class="p">)</span>
<span class="n">sp_norm</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">vmag</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">VEGAMAG</span><span class="p">,</span> <span class="n">v_band</span><span class="p">,</span> <span class="n">vegaspec</span><span class="o">=</span><span class="n">vega</span><span class="p">)</span>
<span class="n">sp_norm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;flam&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Normed Blackbody&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d7b78ceac5105c9fa1e5b5abfb147894541509e866cabba79658026e9c1926f1.png" src="_images/d7b78ceac5105c9fa1e5b5abfb147894541509e866cabba79658026e9c1926f1.png" />
</div>
</div>
<p>Now we initialize the extinction model and choose an extinction of <span class="math notranslate nohighlight">\(A_V\)</span> = 2.  To get the <code class="docutils literal notranslate"><span class="pre">dust_extinction</span></code> model working with <code class="docutils literal notranslate"><span class="pre">synphot</span></code>, we create a wavelength array and make a spectral element with the extinction model as a lookup table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize the extinction model and choose the extinction, here Av = 2.</span>
<span class="n">ext</span> <span class="o">=</span> <span class="n">CCM89</span><span class="p">(</span><span class="n">Rv</span><span class="o">=</span><span class="mf">3.1</span><span class="p">)</span>
<span class="n">Av</span> <span class="o">=</span> <span class="mf">2.0</span>

<span class="c1"># Create a wavelength array.</span>
<span class="n">wav</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>

<span class="c1"># Make the extinction model in synphot using a lookup table.</span>
<span class="n">ex</span> <span class="o">=</span> <span class="n">ReddeningLaw</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span><span class="o">.</span><span class="n">extinction_curve</span><span class="p">(</span><span class="n">Av</span> <span class="o">/</span> <span class="n">ext</span><span class="o">.</span><span class="n">Rv</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">wav</span><span class="p">)</span>
<span class="n">sp_ext</span> <span class="o">=</span> <span class="n">sp_norm</span> <span class="o">*</span> <span class="n">ex</span>
<span class="n">sp_ext</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">left</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">15000</span><span class="p">,</span> <span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;flam&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Normed Blackbody with Extinction&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d4e9340749b4a05d7d4d211915636fe182203ae602ef73590d28dd97f647e612.png" src="_images/d4e9340749b4a05d7d4d211915636fe182203ae602ef73590d28dd97f647e612.png" />
</div>
</div>
<p>Synthetic photometry refers to modeling an observation of a star by multiplying the theoretical model for the astronomical flux through a certain filter response function, then integrating.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># &quot;Observe&quot; the star through the filter and integrate to get photometric mag.</span>
<span class="n">sp_obs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">(</span><span class="n">sp_ext</span><span class="p">,</span> <span class="n">v_band</span><span class="p">)</span>
<span class="n">sp_obs_before</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">(</span><span class="n">sp_norm</span><span class="p">,</span> <span class="n">v_band</span><span class="p">)</span>
<span class="c1"># sp_obs.plot(left=1, right=15000, flux_unit=&#39;flam&#39;,</span>
<span class="c1">#             title=&#39;Normed Blackbody with Extinction through V Filter&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, <code class="docutils literal notranslate"><span class="pre">synphot</span></code> performs the integration and computes magnitudes in the Vega system.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp_stim_before</span> <span class="o">=</span> <span class="n">sp_obs_before</span><span class="o">.</span><span class="n">effstim</span><span class="p">(</span><span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;vegamag&quot;</span><span class="p">,</span> <span class="n">vegaspec</span><span class="o">=</span><span class="n">vega</span><span class="p">)</span>
<span class="n">sp_stim</span> <span class="o">=</span> <span class="n">sp_obs</span><span class="o">.</span><span class="n">effstim</span><span class="p">(</span><span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;vegamag&quot;</span><span class="p">,</span> <span class="n">vegaspec</span><span class="o">=</span><span class="n">vega</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;before dust, V =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sp_stim_before</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;after dust, V =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sp_stim</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="c1"># Calculate extinction and compare to our chosen value.</span>
<span class="n">Av_calc</span> <span class="o">=</span> <span class="n">sp_stim</span> <span class="o">-</span> <span class="n">sp_stim_before</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;$A_V$ = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">Av_calc</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>before dust, V = 10.0 mag(VEGA)
after dust, V = 12.0 mag(VEGA)
$A_V$ =  2.0 mag
</pre></div>
</div>
</div>
</div>
<p>This is a good check for us to do.  We normalized our spectrum to <span class="math notranslate nohighlight">\(V\)</span> = 10 mag and added 2 mag of visual extinction, so the synthetic photometry procedure should reproduce these chosen values, and it does.  Now we are ready to find the extinction in other passbands.</p>
<p>We calculate the new photometry for the rest of the Johnson optical and the Bessell infrared filters. We calculate extinction <span class="math notranslate nohighlight">\(A = \Delta m\)</span> and plot color excess, <span class="math notranslate nohighlight">\(E(\lambda - V) = A_\lambda - A_V\)</span>.</p>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">synphot</span></code> calculates the effective wavelength of the observations for us, which is very useful for plotting the results.  We show reddening with the model extinction curve for comparison in the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="n">u_band</span><span class="p">,</span> <span class="n">b_band</span><span class="p">,</span> <span class="n">v_band</span><span class="p">,</span> <span class="n">r_band</span><span class="p">,</span> <span class="n">i_band</span><span class="p">,</span> <span class="n">j_band</span><span class="p">,</span> <span class="n">h_band</span><span class="p">,</span> <span class="n">k_band</span><span class="p">]</span>

<span class="k">for</span> <span class="n">band</span> <span class="ow">in</span> <span class="n">bands</span><span class="p">:</span>
    <span class="c1"># Calculate photometry with dust:</span>
    <span class="n">sp_obs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">(</span><span class="n">sp_ext</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="s2">&quot;extrap&quot;</span><span class="p">)</span>
    <span class="n">obs_effstim</span> <span class="o">=</span> <span class="n">sp_obs</span><span class="o">.</span><span class="n">effstim</span><span class="p">(</span><span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;vegamag&quot;</span><span class="p">,</span> <span class="n">vegaspec</span><span class="o">=</span><span class="n">vega</span><span class="p">)</span>
    <span class="c1"># Calculate photometry without dust:</span>
    <span class="n">sp_obs_i</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">(</span><span class="n">sp_norm</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="s2">&quot;extrap&quot;</span><span class="p">)</span>
    <span class="n">obs_i_effstim</span> <span class="o">=</span> <span class="n">sp_obs_i</span><span class="o">.</span><span class="n">effstim</span><span class="p">(</span><span class="n">flux_unit</span><span class="o">=</span><span class="s2">&quot;vegamag&quot;</span><span class="p">,</span> <span class="n">vegaspec</span><span class="o">=</span><span class="n">vega</span><span class="p">)</span>

    <span class="c1"># Extinction = mag with dust - mag without dust</span>
    <span class="c1"># Color excess = extinction at lambda - extinction at V</span>
    <span class="n">color_excess</span> <span class="o">=</span> <span class="n">obs_effstim</span> <span class="o">-</span> <span class="n">obs_i_effstim</span> <span class="o">-</span> <span class="n">Av_calc</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp_obs_i</span><span class="o">.</span><span class="n">effective_wavelength</span><span class="p">(),</span> <span class="n">color_excess</span><span class="p">,</span> <span class="s2">&quot;or&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">sp_obs_i</span><span class="o">.</span><span class="n">effective_wavelength</span><span class="p">(),</span> <span class="mi">1</span><span class="p">),</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">color_excess</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># Plot the model extinction curve for comparison</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wav</span><span class="p">,</span> <span class="n">Av</span> <span class="o">*</span> <span class="n">ext</span><span class="p">(</span><span class="n">wav</span><span class="p">)</span> <span class="o">-</span> <span class="n">Av</span><span class="p">,</span> <span class="s2">&quot;--k&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\lambda$ (Angstrom)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;E($\lambda$-V)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Reddening of T=10,000K Background Source with Av=2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3601.5 Angstrom , 1.12 mag
4368.9 Angstrom , 0.63 mag
5463.8 Angstrom , 0.0 mag
6810.6 Angstrom , -0.48 mag
8619.6 Angstrom , -0.97 mag
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12266.5 Angstrom , -1.43 mag
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16351.9 Angstrom , -1.65 mag
21956.7 Angstrom , -1.79 mag
</pre></div>
</div>
<img alt="_images/666d0af0e2e99da105ad3de6740cf2a80a42313fcd2090fdd79178c84ac0b10c.png" src="_images/666d0af0e2e99da105ad3de6740cf2a80a42313fcd2090fdd79178c84ac0b10c.png" />
</div>
</div>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h2>
<p>Try changing the blackbody temperature to something very hot or very cool.  Are the color excess values the same?  Have the effective wavelengths changed?</p>
<p>Note that the photometric extinction changes because the filter transmission is not uniform. The observed throughput of the filter depends on the shape of the background source flux.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "astropy-learn/tutorial--color-excess",
            ref: "main/",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By AUTHOR1 (@GITHUB-USERNAME, ORCID-ID), AUTHOR2 (@GITHUB-USERNAME, ORCID-ID)
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>